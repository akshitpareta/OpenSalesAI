# =============================================================================
# OpenSalesAI — Environment Variables
# =============================================================================
# Copy this file to .env and update values for your environment:
#   cp .env.example .env
#
# SECURITY: Never commit .env to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# General
# -----------------------------------------------------------------------------
NODE_ENV=development
APP_NAME=OpenSalesAI
APP_URL=http://localhost:3000
LOG_LEVEL=info
# Timezone for cron jobs and display (IST for Indian market)
TZ=Asia/Kolkata

# -----------------------------------------------------------------------------
# PostgreSQL
# -----------------------------------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=opensalesai
POSTGRES_PASSWORD=opensalesai_secret
POSTGRES_DB=opensalesai

# Prisma connection URL (used by services)
DATABASE_URL=postgresql://opensalesai:opensalesai_secret@localhost:5432/opensalesai?schema=public

# -----------------------------------------------------------------------------
# Redis
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=opensalesai_redis
REDIS_URL=redis://:opensalesai_redis@localhost:6379/0

# -----------------------------------------------------------------------------
# Qdrant (Vector Database)
# -----------------------------------------------------------------------------
QDRANT_HOST=localhost
QDRANT_REST_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_URL=http://localhost:6333
# Optional: Qdrant API key (disabled by default in dev)
# QDRANT_API_KEY=

# -----------------------------------------------------------------------------
# MinIO (S3-Compatible Object Storage)
# -----------------------------------------------------------------------------
MINIO_ENDPOINT=localhost
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=opensalesai
MINIO_ROOT_PASSWORD=opensalesai_minio_secret
MINIO_BUCKET_UPLOADS=opensalesai-uploads
MINIO_BUCKET_ML_ARTIFACTS=mlflow-artifacts
# S3-compatible URL for SDKs
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=opensalesai
S3_SECRET_KEY=opensalesai_minio_secret

# -----------------------------------------------------------------------------
# Keycloak (Identity & Access Management)
# -----------------------------------------------------------------------------
KEYCLOAK_PORT=8080
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=admin_secret
KEYCLOAK_BASE_URL=http://localhost:8080
KEYCLOAK_REALM=opensalesai
KEYCLOAK_CLIENT_ID=opensalesai-api
KEYCLOAK_CLIENT_SECRET=change-me-to-a-real-secret
# Frontend client (public, no secret)
KEYCLOAK_FRONTEND_CLIENT_ID=opensalesai-dashboard

# -----------------------------------------------------------------------------
# n8n (Workflow Engine)
# -----------------------------------------------------------------------------
N8N_PORT=5678
N8N_HOST=localhost
N8N_WEBHOOK_URL=http://localhost:5678/
N8N_ENCRYPTION_KEY=change-me-to-a-random-string-at-least-32-chars

# -----------------------------------------------------------------------------
# Ollama (Local LLM)
# -----------------------------------------------------------------------------
OLLAMA_HOST=localhost
OLLAMA_PORT=11434
OLLAMA_BASE_URL=http://localhost:11434
# Default model for task generation and order parsing
OLLAMA_DEFAULT_MODEL=llama3.1:8b
# Number of parallel inference requests
OLLAMA_NUM_PARALLEL=4
# Max models loaded simultaneously (you have 64GB VRAM with 2x RTX 5090)
OLLAMA_MAX_LOADED_MODELS=2

# -----------------------------------------------------------------------------
# LLM API Keys (Cloud Fallback)
# -----------------------------------------------------------------------------
# If Ollama is unavailable, these are used as fallback.
# Uncomment and set the one(s) you want to use.
# ANTHROPIC_API_KEY=sk-ant-xxxxx
# OPENAI_API_KEY=sk-xxxxx
# LLM_PROVIDER=ollama  # Options: ollama, anthropic, openai

# -----------------------------------------------------------------------------
# Caddy (Reverse Proxy)
# -----------------------------------------------------------------------------
CADDY_HTTP_PORT=80
CADDY_HTTPS_PORT=443
# Domain name for production (Caddy auto-TLS)
# DOMAIN_NAME=opensalesai.example.com

# -----------------------------------------------------------------------------
# Prometheus & Grafana (Monitoring)
# -----------------------------------------------------------------------------
PROMETHEUS_PORT=9090
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin_secret
GRAFANA_ROOT_URL=http://localhost:3001

# -----------------------------------------------------------------------------
# MLflow (ML Experiment Tracking)
# -----------------------------------------------------------------------------
MLFLOW_PORT=5000
MLFLOW_TRACKING_URI=http://localhost:5000
MLFLOW_BACKEND_STORE_URI=postgresql://opensalesai:opensalesai_secret@localhost:5432/mlflow
MLFLOW_S3_ENDPOINT_URL=http://localhost:9000

# -----------------------------------------------------------------------------
# WhatsApp Business Cloud API
# -----------------------------------------------------------------------------
# Obtain from Meta Business Suite: https://developers.facebook.com/
WHATSAPP_API_URL=https://graph.facebook.com/v18.0
WHATSAPP_PHONE_NUMBER_ID=your-phone-number-id
WHATSAPP_ACCESS_TOKEN=your-access-token
WHATSAPP_VERIFY_TOKEN=your-webhook-verify-token
WHATSAPP_BUSINESS_ACCOUNT_ID=your-business-account-id

# -----------------------------------------------------------------------------
# API Gateway
# -----------------------------------------------------------------------------
API_GATEWAY_HOST=localhost
API_GATEWAY_PORT=4000
API_GATEWAY_URL=http://localhost:4000
# JWT signing secret (for internal service tokens; Keycloak handles user JWTs)
JWT_SECRET=change-me-to-a-long-random-string
# Rate limiting: max requests per window
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000

# -----------------------------------------------------------------------------
# SFA Service (Sales Force Automation)
# -----------------------------------------------------------------------------
SFA_SERVICE_PORT=4001
SFA_SERVICE_URL=http://localhost:4001
# GPS validation: max distance (meters) to accept store check-in
GPS_CHECKIN_RADIUS_METERS=100
# Minimum visit duration (minutes) to count as valid
MIN_VISIT_DURATION_MINUTES=5

# -----------------------------------------------------------------------------
# eB2B Service (eCommerce B2B)
# -----------------------------------------------------------------------------
EB2B_SERVICE_PORT=4002
EB2B_SERVICE_URL=http://localhost:4002

# -----------------------------------------------------------------------------
# AI Service (Python FastAPI)
# -----------------------------------------------------------------------------
AI_SERVICE_HOST=localhost
AI_SERVICE_PORT=8000
AI_SERVICE_URL=http://localhost:8000
# Embedding model for RAG
EMBEDDING_MODEL=all-MiniLM-L6-v2
# Task generation batch size
TASK_GENERATION_BATCH_SIZE=50

# -----------------------------------------------------------------------------
# Notification Service
# -----------------------------------------------------------------------------
NOTIFICATION_SERVICE_PORT=4003
NOTIFICATION_SERVICE_URL=http://localhost:4003
# Firebase Cloud Messaging (for push notifications)
# FCM_PROJECT_ID=your-firebase-project-id
# FCM_PRIVATE_KEY=your-private-key
# FCM_CLIENT_EMAIL=your-client-email
# SMS Gateway (e.g., Twilio, MSG91)
# SMS_PROVIDER=msg91
# SMS_API_KEY=your-sms-api-key
# SMS_SENDER_ID=OSALAI

# -----------------------------------------------------------------------------
# Frontend — Dashboard (Next.js)
# -----------------------------------------------------------------------------
NEXT_PUBLIC_API_URL=http://localhost:4000
NEXT_PUBLIC_KEYCLOAK_URL=http://localhost:8080
NEXT_PUBLIC_KEYCLOAK_REALM=opensalesai
NEXT_PUBLIC_KEYCLOAK_CLIENT_ID=opensalesai-dashboard
NEXT_PUBLIC_MAPBOX_TOKEN=your-mapbox-public-token
NEXTAUTH_SECRET=change-me-to-a-random-string
NEXTAUTH_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Frontend — Retailer PWA (Next.js)
# -----------------------------------------------------------------------------
RETAILER_PWA_PORT=3002
NEXT_PUBLIC_RETAILER_API_URL=http://localhost:4002

# -----------------------------------------------------------------------------
# Metabase (Analytics BI)
# -----------------------------------------------------------------------------
# METABASE_PORT=3003
# MB_DB_TYPE=postgres
# MB_DB_DBNAME=metabase
# MB_DB_PORT=5432
# MB_DB_USER=opensalesai
# MB_DB_PASS=opensalesai_secret
# MB_DB_HOST=postgres

# -----------------------------------------------------------------------------
# Multi-Tenancy
# -----------------------------------------------------------------------------
# Default tenant for development
DEFAULT_TENANT_ID=00000000-0000-0000-0000-000000000001
DEFAULT_COMPANY_ID=00000000-0000-0000-0000-000000000001

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Structured JSON logging
LOG_FORMAT=json
# Correlation ID header name
CORRELATION_ID_HEADER=x-correlation-id
